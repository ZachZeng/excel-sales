{"version":3,"sources":["logo.svg","elements/StyledElements.js","components/FileProcess.js","components/Layout.js","components/ReplaceDropzone.js","components/SaleDropzone.js","components/Header.js","components/SaleProcess.js","App.js","reportWebVitals.js","index.js"],"names":["LayoutWrapper","styled","div","DropzoneWrapper","props","getColor","isDragAccept","isDragReject","isDragActive","ExportButton","button","table","FileProcess","saleData","replaceData","useState","Date","billDate","setBillDate","dispatchDate","setDispatchDate","num","setNum","dict","setDict","useEffect","map","item","brand","price","fileProcess","_data","data","brandColumn","priceColumn","nColumn","numRow","totalPrice","key","v","charAt","substring","i","console","log","parseInt","parseFloat","toLocaleDateString","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","toString","style","marginBottom","selected","onChange","date","value","event","target","replace","onClick","wb","Sheets","sale","SheetNames","excelBuffer","XLSX","bookType","type","Blob","FileSaver","filename","alert","Layout","children","ReplaceDropzone","setData","onDrop","useCallback","acceptedFiles","f","name","reader","FileReader","onload","evt","bstr","result","cellDates","wsnames","sheet_to_json","dateNF","onDropFile","readAsBinaryString","useDropzone","accept","getRootProps","getInputProps","isDragAccepted","rejectedFiles","SaleDropzone","setSaleData","Header","fontSize","SaleProcess","setReplaceData","dropSaleData","undefined","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.64feb657.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/logo.103b5fa1.svg\";","import styled from \"styled-components\";\n\nexport const LayoutWrapper = styled.div`\n  @import url(\"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100;400;700&display=swap\");\n  height: 100vh;\n  padding: 5rem 10rem;\n  font-family: \"Noto Sans SC\", sans-serif;\n`;\n\nexport const DZDropzoneWrapper = styled.div`\n  width: 100%;\n  height: 100%;\n  display: flex;\n`;\n\nexport const DropzoneWrapper = styled.div`\n  input {\n    width: 100%;\n    height: 100%;\n  }\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 3rem;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ${props => getColor(props)};\n  border-style: dashed;\n  background-color: #fafafa;\n  color: #bdbdbd;\n  outline: none;\n  cursor: pointer;\n  transition: border 0.24s ease-in-out;\n`;\n\nconst getColor = props => {\n  if (props.isDragAccept) {\n    return \"#00e676\";\n  }\n  if (props.isDragReject) {\n    return \"#ff1744\";\n  }\n  if (props.isDragActive) {\n    return \"#2196f3\";\n  }\n  return \"#eeeeee\";\n};\n\nexport const FileProcessWrapper = styled.div`\n  padding: 3rem 0;\n`;\n\nexport const FilenameWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  height: 2.5rem;\n  padding: 2rem;\n  background: #fafafa;\n  align-items: center;\n  svg {\n    height: 100%;\n    width: 4rem;\n  }\n  p {\n    font-weight: bold;\n    font-size: 2rem;\n    color: #2e7d32;\n  }\n`;\n\nexport const FilterWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  background: #eef4ee;\n  height: 23rem;\n  justify-content: start;\n  color: #575757;\n  padding: 2rem 3rem;\n\n  h2 {\n    padding: 0;\n    margin: 0.5rem 0rem;\n  }\n`;\n\nexport const FilterTextWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  margin-right: 5rem;\n  width: 20rem;\n`;\n\nexport const FilterDateWrapper = styled.div`\n  width: 25rem;\n`;\n\nexport const FilterMonthSelector = styled.button`\n  font-family: \"Noto Sans SC\", sans-serif;\n  padding: 0.5rem 1.5rem;\n  font-size: 1rem;\n  border: none;\n  background: #61988e;\n  color: white;\n  cursor: pointer;\n  transition: all 0.5s;\n  &:active,\n  :focus,\n  :hover {\n    background: #2f5f56;\n  }\n`;\n\nexport const ResultWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  background: #dff2df;\n  justify-content: start;\n  color: #575757;\n  padding: 3rem 3rem;\n\n  h2 {\n    padding: 0;\n    margin: 0.5rem 0rem;\n  }\n`;\n\nexport const CalcButton = styled.button`\n  padding: 0.6rem 1.5rem;\n  width: max-content;\n  background: #61988e;\n  border: none;\n  color: #fff;\n  font-weight: bold;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.3s;\n  &:hover {\n    background: #3e746a;\n    color: #fff;\n  }\n`;\n\nexport const ExportButton = styled.button`\n  padding: 0.6rem 1.2rem;\n  display: block;\n  width: max-content;\n  background: #61988e;\n  border: none;\n  color: #fff;\n  font-weight: bold;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.3s;\n  &:hover {\n    background: #3e746a;\n    color: #fff;\n  }\n  margin-top: 1rem;\n`;\n\nexport const ErrorMessage = styled.div`\n  padding: 2rem 0rem;\n  font-weight: bolder;\n  color: #ed5757;\n`;\n\nexport const ResultsHeader = styled.div`\n  display: flex;\n  flex-direction: column;\n  h2 {\n    font-size: 1.75rem;\n  }\n  h3 {\n    font-weight: normal;\n  }\n\n  span {\n    margin-right: 3rem;\n  }\n`;\n\nexport const ResultsTable = styled.table`\n  border-collapse: collapse;\n  width: 100%;\n  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);\n\n  td,\n  th {\n    border: 2px solid #eef4ee;\n    text-align: left;\n    padding: 1.5rem;\n  }\n\n  th {\n    font-size: 1.5rem;\n  }\n\n  tr {\n    background-color: #fff;\n  }\n  tr:nth-child(even) {\n    background-color: #eef4ee;\n  }\n`;\n","import React, { useState, useEffect } from \"react\";\nimport * as FileSaver from \"file-saver\";\nimport * as XLSX from \"xlsx\";\nimport { ExportButton } from \"../elements/StyledElements\";\nimport DatePicker, { registerLocale, setDefaultLocale } from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\n\nexport const FileProcess = ({ saleData, replaceData }) => {\n  const [billDate, setBillDate] = useState(new Date());\n  const [dispatchDate, setDispatchDate] = useState(new Date());\n  const [num, setNum] = useState(\"\");\n  const [dict, setDict] = useState();\n  useEffect(() => {\n    let dict = {};\n    replaceData.map(item => {\n      dict[item[\"产品名称\"]] = { brand: item[\"替代品种\"], price: item[\"单价\"] };\n    });\n    setDict(dict);\n  }, [replaceData]);\n\n  const exportToExcel = () => {\n    if (saleData === \"\") {\n      alert(\"无数据\");\n      return;\n    }\n\n    if (num == \"\") {\n      alert(\"请输入镜片类合计数量\");\n      return;\n    }\n\n    let newData = fileProcess(saleData);\n\n    const fileType =\n      \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\n    const fileExtension = \".xlsx\";\n\n    const wb = {\n      Sheets: { sale: newData },\n      SheetNames: [\"sale\"]\n    };\n    const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n    const data = new Blob([excelBuffer], { type: fileType });\n    const filename = \"出货单_新\";\n    FileSaver.saveAs(data, filename + fileExtension);\n  };\n\n  const fileProcess = _data => {\n    let data = { ..._data };\n    let brandColumn = \"\";\n    let priceColumn = \"\";\n    let nColumn = \"\";\n    let numRow = 0;\n    let totalPriceColumn = \"U\";\n    let totalPrice = 0;\n    for (const key in data) {\n      switch (data[key].v) {\n        case \"产品名称\":\n          brandColumn = key.charAt(0);\n          break;\n        case \"数量\":\n          nColumn = key.charAt(0);\n          break;\n        case \"单价\":\n          priceColumn = key.charAt(0);\n          break;\n        case \"镜片类合计数量：\":\n          numRow = key.substring(1);\n          break;\n        default:\n          break;\n      }\n    }\n    let i = 9;\n    while (1) {\n      if (data[`A${i}`].v == \"镜片类合计数量：\") {\n        break;\n      }\n\n      console.log(data[`${brandColumn}${i}`].v);\n      console.log(dict[data[`${brandColumn}${i}`].v]);\n      if (dict[data[`${brandColumn}${i}`].v]) {\n        data[`${priceColumn}${i}`].v = dict[data[`${brandColumn}${i}`].v].price;\n        data[`${brandColumn}${i}`].v = dict[data[`${brandColumn}${i}`].v].brand;\n      }\n      let n = parseInt(data[`${nColumn}${i}`].v);\n      totalPrice += n * parseFloat(data[`${priceColumn}${i}`].v);\n\n      i++;\n    }\n\n    data[\"K5\"].v = billDate.toLocaleDateString(\"zh-cn\");\n    data[\"K6\"].v = dispatchDate.toLocaleDateString(\"zh-cn\");\n\n    var datestring =\n      new Date().getFullYear() +\n      \"/\" +\n      (new Date().getMonth() + 1) +\n      \"/\" +\n      new Date().getDate() +\n      \" \" +\n      new Date().getHours() +\n      \":\" +\n      new Date().getMinutes() +\n      \":\" +\n      new Date().getSeconds();\n\n    data[`F${numRow}`].v = num.toString();\n    data[`${totalPriceColumn}${numRow}`].v = totalPrice.toString();\n\n    return data;\n  };\n\n  return (\n    <div style={{ marginBottom: 100 }}>\n      <div>\n        <h4>开单日期</h4>\n        <DatePicker selected={billDate} onChange={date => setBillDate(date)} />\n      </div>\n      <div>\n        <h4>出货日期</h4>\n        <DatePicker\n          selected={dispatchDate}\n          onChange={date => setDispatchDate(date)}\n        />\n      </div>\n      <div>\n        <h4>合计数量</h4>\n        <input\n          value={num}\n          onChange={event => setNum(event.target.value.replace(/\\D/, \"\"))}\n        />\n      </div>\n\n      <ExportButton onClick={exportToExcel}>导出</ExportButton>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { LayoutWrapper } from \"../elements/StyledElements\";\n\nexport const Layout = ({ children }) => {\n  return <LayoutWrapper>{children}</LayoutWrapper>;\n};\n","import React, { useCallback, useState } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { FileProcess } from \".\";\nimport { DropzoneWrapper } from \"../elements/StyledElements\";\nimport * as XLSX from \"xlsx\";\n\nexport const ReplaceDropzone = props => {\n  const [data, setData] = useState();\n\n  const onDrop = useCallback(acceptedFiles => {\n    var f = acceptedFiles[0];\n    if (!f) {\n      return;\n    }\n    var name = f.name;\n    const reader = new FileReader();\n    reader.onload = evt => {\n      // evt = on_file_select event\n      /* Parse data */\n      const bstr = evt.target.result;\n      // var length = bstr.byteLength;\n      // var binary = \"\";\n      // for (var i = 0; i < length; i++) {\n      //   binary += String.fromCharCode(bstr[i]);\n      // }\n\n      const wb = XLSX.read(bstr, {\n        type: \"binary\",\n        cellDates: true\n      });\n      /* Get worksheets */\n      const wsnames = wb.SheetNames;\n\n      /* Convert to json */\n      const data = XLSX.utils.sheet_to_json(wb.Sheets[wsnames[0]], {\n        dateNF: \"mm/dd/yyyy;@\"\n      });\n      /* Update state */\n      setData(data);\n      props.onDropFile(data);\n    };\n    reader.readAsBinaryString(f);\n  }, []);\n\n  const {\n    isDragActive,\n    getRootProps,\n    getInputProps,\n    isDragReject,\n    isDragAccepted,\n    acceptedFiles,\n    rejectedFiles\n  } = useDropzone({\n    onDrop,\n    accept: \".xlsx, .xls\"\n  });\n\n  return (\n    <>\n      <h3>产品代替</h3>\n      <DropzoneWrapper {...getRootProps()}>\n        <input {...getInputProps()} />\n        {!isDragActive && \"点击这里或者拖拽文件至这里进行上传\"}\n        {isDragActive && \"放下文件\"}\n      </DropzoneWrapper>\n    </>\n  );\n};\n","import React, { useCallback, useState } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { FileProcess } from \".\";\nimport { DropzoneWrapper } from \"../elements/StyledElements\";\nimport * as XLSX from \"xlsx\";\n\nexport const SaleDropzone = props => {\n  const [saleData, setSaleData] = useState();\n\n  const onDrop = useCallback(acceptedFiles => {\n    var f = acceptedFiles[0];\n    if (!f) {\n      return;\n    }\n    var name = f.name;\n    const reader = new FileReader();\n    reader.onload = evt => {\n      // evt = on_file_select event\n      /* Parse data */\n      const bstr = evt.target.result;\n      // var length = bstr.byteLength;\n      // var binary = \"\";\n      // for (var i = 0; i < length; i++) {\n      //   binary += String.fromCharCode(bstr[i]);\n      // }\n\n      const wb = XLSX.read(bstr, {\n        type: \"binary\",\n        cellDates: true\n      });\n\n      /* Get worksheets */\n      const wsnames = wb.SheetNames;\n\n      /* Convert to json */\n      const saleData = wb.Sheets[wsnames[0]];\n      /* Update state */\n      setSaleData(saleData);\n\n      props.onDropFile(saleData);\n    };\n    reader.readAsBinaryString(f);\n  }, []);\n\n  const {\n    isDragActive,\n    getRootProps,\n    getInputProps,\n    isDragReject,\n    isDragAccepted,\n    acceptedFiles,\n    rejectedFiles\n  } = useDropzone({\n    onDrop,\n    accept: \".xlsx, .xls\"\n  });\n\n  return (\n    <>\n      <h3>出货单</h3>\n      <DropzoneWrapper {...getRootProps()}>\n        <input {...getInputProps()} />\n        {!isDragActive && \"点击这里或者拖拽文件至这里进行上传\"}\n        {isDragActive && \"放下文件\"}\n      </DropzoneWrapper>\n    </>\n  );\n};\n","import React from \"react\";\n\nexport function Header() {\n  return (\n    <div>\n      <h1 style={{ fontSize: \"3rem\" }}>出货单修改</h1>\n    </div>\n  );\n}\n","import React, { useState } from \"react\";\nimport { SaleDropzone, ReplaceDropzone } from \"./index\";\nimport { FileProcess } from \"./FileProcess\";\n\nexport const SaleProcess = () => {\n  const [saleData, setSaleData] = useState();\n  const [replaceData, setReplaceData] = useState();\n\n  const handleSaleDrop = dropSaleData => {\n    setSaleData(dropSaleData);\n  };\n\n  const handleReplaceDrop = data => {\n    setReplaceData(data);\n  };\n\n  console.log(\"saleData\", saleData);\n  console.log(\"replaceData\", replaceData);\n\n  return (\n    <div>\n      <SaleDropzone onDropFile={handleSaleDrop} />\n      <ReplaceDropzone onDropFile={handleReplaceDrop} />\n      {replaceData === undefined || saleData === undefined ? (\n        <div>\n          <p></p>\n        </div>\n      ) : (\n        <FileProcess saleData={saleData} replaceData={replaceData} />\n      )}\n    </div>\n  );\n};\n","import logo from \"./logo.svg\";\nimport \"./App.css\";\nimport { Header, Layout, SaleProcess } from \"./components\";\n\nfunction App() {\n  return (\n    <Layout>\n      <Header />\n      <SaleProcess />\n    </Layout>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}